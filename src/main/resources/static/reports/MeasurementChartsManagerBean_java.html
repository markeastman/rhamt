<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Source Report for MeasurementChartsManagerBean.java</title>
    <link href="resources/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="resources/css/windup.css" rel="stylesheet" media="screen"/>
    <link rel="stylesheet" type="text/css" href="resources/libraries/snippet/jquery.snippet.min.css" />
    <link rel="stylesheet" type="text/css" href="resources/css/windup-source.css" />
    <link rel="stylesheet" type="text/css" href="resources/libraries/sausage/sausage.css" />
    <link rel="shortcut icon" href="resources/img/rhamt-icon-128.png" type="image/x-icon"/>
</head>
<body role="document" class="source-report">

    <div class="navbar navbar-default navbar-fixed-top" id="main-navbar" style="display: none">
        <div class="wu-navbar-header navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <span class="wu-navbar-header">
              <strong class="wu-navbar-header">Red Hat Application Migration Toolkit</strong>
            </span>        </div>


                <div class="navbar-collapse collapse navbar-responsive-collapse project-specific" data-project-id="4062208">
    <ul class="nav navbar-nav">
            <li class="">
                <a href="../index.html"><i class="glyphicon glyphicon-home"></i> All Applications</a>
            </li>



                <li class="">
                    <a href="report_index_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon glyphicon-dashboard"></i>
                      Dashboard
                    </a>
                </li>


                <li class="">
                    <a href="migration_issues.1.html">
                        <i class="glyphicon glyphicon-warning-sign"></i>
                      Issues
                    </a>
                </li>


                <li class="">
                    <a href="ApplicationDetails_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon glyphicon-th-list"></i>
                      Application Details
                    </a>
                </li>


                <li class="">
                    <a href="dependency_report_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon glyphicon-compressed"></i>
                      Dependencies
                    </a>
                </li>


                <li class="">
                    <a href="remotereport_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon service-nav-logo"></i>
                      Remote Services
                    </a>
                </li>


                <li class="">
                    <a href="ejbreport_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon ejb-nav-logo"></i>
                      EJBs
                    </a>
                </li>


                <li class="">
                    <a href="jpa_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon jpa-nav-logo"></i>
                      JPA
                    </a>
                </li>


                <li class="">
                    <a href="server_resources_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon server-resource-nav-logo"></i>
                      Server Resources
                    </a>
                </li>


                <li class="">
                    <a href="hardcoded_ipsRHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon glyphicon-map-marker"></i>
                      Hard-coded IP Addresses
                    </a>
                </li>


                <li class="">
                    <a href="ignoredfiles_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon glyphicon-eye-close"></i>
                      Ignored Files
                    </a>
                </li>


                <li class="">
                    <a href="about_RHQ_Enterprise_Server_EAR.html">
                        <i class="glyphicon glyphicon-info-sign"></i>
                      About
                    </a>
                </li>
    </ul>
    <ul class="nav navbar-nav navbar-right">
<li>
    <a href="#" class="feedback-nav-btn jiraFeedbackTrigger"><i class="glyphicon glyphicon-comment"></i> Send Feedback </a>
</li>


    <script type="text/javascript" src="https://issues.jboss.org/s/f215932e68571747ac58d0f5d554396f-T/en_US-r7luaf/6346/82/1.4.16/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-US&amp;collectorId=8b9e338b"></script>

    <script type="text/javascript">

    var FEEDBACK_JS_ADDED = false;
    var FEEDBACK_FORM_TRIGGER = null;

    function displayFeedbackForm() {
        FEEDBACK_FORM_TRIGGER();
    }

    window.ATL_JQ_PAGE_PROPS = {
        "triggerFunction": function(showCollectorDialog) {
            FEEDBACK_FORM_TRIGGER = showCollectorDialog;
        }
    };

    document.addEventListener("DOMContentLoaded", function(event) {
            jQuery(".jiraFeedbackTrigger").click(function(e) {
                e.preventDefault();
                displayFeedbackForm();
            });
    });
    </script>
    </ul>
                </div><!-- /.nav-collapse -->
    </div>


    <div class="container-fluid" role="main">
        <div class="row">
            <div class="page-header page-header-no-border">
                <h1>
                    <div class="main">Source Report</div>

                        <div class="path project-specific" data-project-id="4062208">
                            rhq-enterprise-server-ear-1.3.0.EmbJopr.1.3.0-4.ear/rhq-enterprise-server-ejb3.jar/org/rhq/enterprise/server/measurement/MeasurementChartsManagerBean.java
                        </div>
                </h1>
                <div class="desc">
                    This report displays what Red Hat Application Migration Toolkit found in individual files.
                    Each item is shown below the line it was found on,
                    and next to it, you may find a link to the rule which it was found by.
                </div>
            </div>
        </div>

        <div class="row">
            <div class="container-fluid theme-showcase" role="main">

                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Information</h3>
                    </div>
                    <div class="panel-body" style="overflow: auto;">

                        <!--<div style="height: 120pt; float:left;"></div> Keeps the minimal height. -->
                        <div class="points" style="text-align: center; color: #00254b; padding-bottom: 1ex;">
                            <div class="number">0</div>
                            <div>Story Points</div>
                        </div>

                        <div class="info" style="margin-left: 95pt;">

                            <h4>Technologies</h4>
                            <div class="technologies" style="overflow: auto"><!-- "auto" to contain all the tags. -->
                                    <span class="label label-info" title="INFORMATIONAL">Decompiled Java File</span>
                            </div>



                            <div style="clear: both;"/><!-- Snaps under the height keeper. Yes, the same effect could be achieved by a table. -->
                        </div><!-- .info -->
                    </div>
                </div>



                <pre id="source">
package org.rhq.enterprise.server.measurement;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import javax.annotation.Resource;
import javax.ejb.EJB;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.sql.DataSource;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.jboss.annotation.IgnoreDependency;
import org.rhq.core.domain.auth.Subject;
import org.rhq.core.domain.measurement.DataType;
import org.rhq.core.domain.measurement.DisplayType;
import org.rhq.core.domain.measurement.MeasurementDataNumeric;
import org.rhq.core.domain.measurement.MeasurementDataTrait;
import org.rhq.core.domain.measurement.MeasurementDefinition;
import org.rhq.core.domain.measurement.MeasurementSchedule;
import org.rhq.core.domain.measurement.MeasurementUnits;
import org.rhq.core.domain.measurement.NumericType;
import org.rhq.core.domain.util.PageControl;
import org.rhq.core.domain.util.PageList;
import org.rhq.core.util.collection.ArrayUtils;
import org.rhq.enterprise.server.alert.AlertManagerLocal;
import org.rhq.enterprise.server.common.EntityContext;
import org.rhq.enterprise.server.measurement.MeasurementAggregate;
import org.rhq.enterprise.server.measurement.MeasurementChartsManagerLocal;
import org.rhq.enterprise.server.measurement.MeasurementDataManagerLocal;
import org.rhq.enterprise.server.measurement.MeasurementDefinitionManagerLocal;
import org.rhq.enterprise.server.measurement.MeasurementException;
import org.rhq.enterprise.server.measurement.MeasurementNotFoundException;
import org.rhq.enterprise.server.measurement.MeasurementPreferences;
import org.rhq.enterprise.server.measurement.MeasurementScheduleManagerLocal;
import org.rhq.enterprise.server.measurement.MeasurementViewException;
import org.rhq.enterprise.server.measurement.MeasurementViewManagerLocal;
import org.rhq.enterprise.server.measurement.MeasurementPreferences.MetricRangePreferences;
import org.rhq.enterprise.server.measurement.uibean.MetricDisplaySummary;
import org.rhq.enterprise.server.measurement.uibean.MetricDisplayValue;
import org.rhq.enterprise.server.measurement.util.MeasurementDataManagerUtility;
import org.rhq.enterprise.server.measurement.util.MeasurementUtils;
import org.rhq.enterprise.server.resource.ResourceManagerLocal;
import org.rhq.enterprise.server.resource.group.ResourceGroupManagerLocal;

@Stateless
@Resource(
   name = &quot;RHQ_DS&quot;,
   mappedName = &quot;java:/RHQDS&quot;
)
public class MeasurementChartsManagerBean implements MeasurementChartsManagerLocal {
   private final Log log = LogFactory.getLog(MeasurementChartsManagerBean.class);
   @PersistenceContext(
      unitName = &quot;rhqpu&quot;
   )
   private EntityManager entityManager;
   @Resource(
      name = &quot;RHQ_DS&quot;
   )
   private DataSource rhqDs;
   @EJB
   @IgnoreDependency
   private MeasurementDefinitionManagerLocal measurementDefinitionManager;
   @EJB
   @IgnoreDependency
   private ResourceManagerLocal resourceManager;
   @EJB
   private MeasurementDataManagerLocal dataManager;
   @EJB
   private MeasurementScheduleManagerLocal scheduleManager;
   @EJB
   private AlertManagerLocal alertManager;
   @EJB
   private ResourceGroupManagerLocal resourceGroupManager;
   @EJB
   private MeasurementViewManagerLocal viewManager;

   public List getMetricDisplaySummariesForAutoGroup(Subject subject, int autoGroupParentResourceId, int autoGroupChildResourceTypeId, int[] measurementDefinitionIds, long begin, long end, boolean enabledOnly) throws MeasurementException {
      List resources = this.resourceGroupManager.findResourcesForAutoGroup(subject, autoGroupParentResourceId, autoGroupChildResourceTypeId);
      int[] resourceIds = new int[resources.size()];

      for(int ret = 0; ret &lt; resourceIds.length; ++ret) {
         resourceIds[ret] = ((org.rhq.core.domain.resource.Resource)resources.get(ret)).getId();
      }

      List var15 = this.getAggregateMetricDisplaySummaries(subject, resourceIds, measurementDefinitionIds, begin, end, enabledOnly);
      Iterator i$ = var15.iterator();

      while(i$.hasNext()) {
         MetricDisplaySummary tmp = (MetricDisplaySummary)i$.next();
         tmp.setParentId(autoGroupParentResourceId);
         tmp.setChildTypeId(autoGroupChildResourceTypeId);
      }

      return var15;
   }

   public List getMetricDisplaySummariesForCompatibleGroup(Subject subject, int groupId, int[] measurementDefinitionIds, long begin, long end, boolean enabledOnly) throws MeasurementException {
      List resourceIds = this.resourceManager.findExplicitResourceIdsByResourceGroup(groupId);
      List ret = this.getAggregateMetricDisplaySummaries(subject, ArrayUtils.unwrapCollection(resourceIds), measurementDefinitionIds, begin, end, enabledOnly);
      Iterator i$ = ret.iterator();

      while(i$.hasNext()) {
         MetricDisplaySummary tmp = (MetricDisplaySummary)i$.next();
         tmp.setGroupId(groupId);
      }

      return ret;
   }

   public List getMetricDisplaySummariesForAutoGroup(Subject subject, int parent, int type, String viewName) {
      MeasurementPreferences preferences = new MeasurementPreferences(subject);
      MetricRangePreferences rangePreferences = preferences.getMetricRangePreferences();
      long begin = rangePreferences.begin.longValue();
      long end = rangePreferences.end.longValue();

      int[] measurementDefinitionIds;
      try {
         EntityContext summaries = new EntityContext(Integer.valueOf(-1), Integer.valueOf(-1), Integer.valueOf(parent), Integer.valueOf(type));
         measurementDefinitionIds = this.fillDefinitionIdsFromUserPreferences(summaries, viewName, subject);
      } catch (IllegalArgumentException var15) {
         measurementDefinitionIds = this.resourceGroupManager.findDefinitionsForAutoGroup(subject, parent, type, true);
      }

      Object summaries1;
      try {
         summaries1 = this.getMetricDisplaySummariesForAutoGroup(subject, parent, type, measurementDefinitionIds, begin, end, false);
      } catch (MeasurementException var14) {
         this.log.debug(&quot;Can\'t get ViewMetrics for autogroup: &quot; + var14);
         summaries1 = new ArrayList();
      }

      return (List)summaries1;
   }

   public List getMetricDisplaySummariesForCompatibleGroup(Subject subject, int groupId, String viewName) {
      MeasurementPreferences preferences = new MeasurementPreferences(subject);
      MetricRangePreferences rangePreferences = preferences.getMetricRangePreferences();
      long begin = rangePreferences.begin.longValue();
      long end = rangePreferences.end.longValue();

      int[] measurementDefinitionIds;
      try {
         EntityContext summaries = new EntityContext(Integer.valueOf(-1), Integer.valueOf(groupId), Integer.valueOf(-1), Integer.valueOf(-1));
         measurementDefinitionIds = this.fillDefinitionIdsFromUserPreferences(summaries, viewName, subject);
      } catch (IllegalArgumentException var14) {
         measurementDefinitionIds = this.resourceGroupManager.findDefinitionsForCompatibleGroup(subject, groupId, true);
      }

      Object summaries1;
      try {
         summaries1 = this.getMetricDisplaySummariesForCompatibleGroup(subject, groupId, measurementDefinitionIds, begin, end, false);
      } catch (MeasurementException var13) {
         this.log.debug(&quot;Can\'t get ViewMetrics for Compat Group: &quot; + var13);
         summaries1 = new ArrayList();
      }

      return (List)summaries1;
   }

   private int[] fillDefinitionIdsFromUserPreferences(EntityContext context, String viewName, Subject subject) {
      List charts;
      try {
         charts = this.viewManager.getCharts(subject, context, viewName);
         if(charts.isEmpty()) {
            throw new IllegalArgumentException(&quot;No metrics defined&quot;);
         }
      } catch (MeasurementViewException var10) {
         throw new IllegalArgumentException(&quot;No metrics defined&quot;);
      }

      int[] measurementDefinitionIds = new int[charts.size()];
      int i = 0;

      MetricDisplaySummary tmp;
      for(Iterator i$ = charts.iterator(); i$.hasNext(); measurementDefinitionIds[i++] = tmp.getDefinitionId().intValue()) {
         String token = (String)i$.next();
         tmp = MeasurementUtils.parseMetricToken(token);
      }

      return measurementDefinitionIds;
   }

   public List getMetricDisplaySummariesForResource(Subject subject, int resourceId, int[] measurementScheduleIds, long beginTime, long endTime) throws MeasurementException {
      ArrayList allMeasurementData = new ArrayList(measurementScheduleIds.length);
      ArrayList scheduleIds = new ArrayList(measurementScheduleIds.length);
      int[] alerts = measurementScheduleIds;
      int i$ = measurementScheduleIds.length;

      for(int sum = 0; sum &lt; i$; ++sum) {
         int measurementScheduleId = alerts[sum];
         MeasurementSchedule schedule = null;

         try {
            schedule = this.scheduleManager.getScheduleById(subject, measurementScheduleId);
            scheduleIds.add(Integer.valueOf(schedule.getId()));
         } catch (MeasurementNotFoundException var16) {
            throw new MeasurementException(var16);
         }

         MetricDisplaySummary summary = this.getMetricDisplaySummary(subject, schedule, beginTime, endTime, false);
         if(summary != null) {
            summary.setUnits(schedule.getDefinition().getUnits().name());
            allMeasurementData.add(summary);
         }
      }

      Map var17 = this.alertManager.getAlertCountForSchedules(beginTime, endTime, scheduleIds);
      Iterator var18 = allMeasurementData.iterator();

      while(var18.hasNext()) {
         MetricDisplaySummary var19 = (MetricDisplaySummary)var18.next();
         var19.setAlertCount(((Integer)var17.get(var19.getScheduleId())).intValue());
      }

      return allMeasurementData;
   }

   public List getMetricDisplaySummariesForResource(Subject subject, int resourceId, String viewName) throws MeasurementException {
      Object scheds;
      try {
         EntityContext scheduleIds = new EntityContext(Integer.valueOf(resourceId), Integer.valueOf(-1), Integer.valueOf(-1), Integer.valueOf(-1));
         List index = this.viewManager.getCharts(subject, scheduleIds, viewName);
         int[] preferences = new int[index.size()];
         int rangePreferences = 0;

         int end;
         for(Iterator begin = index.iterator(); begin.hasNext(); preferences[rangePreferences++] = end) {
            String arr$ = (String)begin.next();
            arr$ = arr$.split(&quot;,&quot;)[1];
            end = Integer.parseInt(arr$);
         }

         List var17 = this.scheduleManager.findSchedulesByIds(preferences);
         ArrayList var24 = new ArrayList(var17.size());
         int[] var26 = preferences;
         end = preferences.length;

         for(int i$ = 0; i$ &lt; end; ++i$) {
            int idss = var26[i$];
            Iterator i$1 = var17.iterator();

            while(i$1.hasNext()) {
               MeasurementSchedule sch = (MeasurementSchedule)i$1.next();
               if(sch.getId() == idss) {
                  var24.add(sch);
                  break;
               }
            }
         }

         scheds = var24;
      } catch (MeasurementViewException var16) {
         scheds = this.scheduleManager.findSchedulesForResourceAndType(subject, resourceId, DataType.MEASUREMENT, DisplayType.SUMMARY, false);
      }

      int[] var18 = new int[((List)scheds).size()];
      int var19 = 0;

      MeasurementSchedule var22;
      for(Iterator var20 = ((List)scheds).iterator(); var20.hasNext(); var18[var19++] = var22.getId()) {
         var22 = (MeasurementSchedule)var20.next();
      }

      MeasurementPreferences var21 = new MeasurementPreferences(subject);
      MetricRangePreferences var23 = var21.getMetricRangePreferences();
      long var25 = var23.begin.longValue();
      long var27 = var23.end.longValue();
      List var28 = this.getMetricDisplaySummariesForResource(subject, resourceId, var18, var25, var27);
      return var28;
   }

   public List getMetricDisplaySummariesForMetrics(Subject subject, int resourceId, DataType dataType, long begin, long end, boolean narrowed, boolean enabledOnly) throws MeasurementException {
      ArrayList summaries = new ArrayList();
      List scheds = this.scheduleManager.findSchedulesForResourceAndType(subject, resourceId, dataType, (DisplayType)null, enabledOnly);
      ArrayList scheduleIds = new ArrayList(scheds.size());
      Iterator alerts = scheds.iterator();

      MetricDisplaySummary sum;
      while(alerts.hasNext()) {
         MeasurementSchedule i$ = (MeasurementSchedule)alerts.next();
         sum = this.getMetricDisplaySummary(subject, i$, begin, end, narrowed);
         if(sum != null) {
            sum.setResourceId(resourceId);
            summaries.add(sum);
            scheduleIds.add(Integer.valueOf(i$.getId()));
         }
      }

      Map alerts1 = this.alertManager.getAlertCountForSchedules(begin, end, scheduleIds);
      Iterator i$1 = summaries.iterator();

      while(i$1.hasNext()) {
         sum = (MetricDisplaySummary)i$1.next();
         sum.setAlertCount(((Integer)alerts1.get(sum.getScheduleId())).intValue());
      }

      return summaries;
   }

   private MetricDisplaySummary getMetricDisplaySummary(Subject subject, MeasurementSchedule schedule, long begin, long end, boolean narrowed) throws MeasurementException {
      MetricDisplaySummary summary = new MetricDisplaySummary();
      summary.setScheduleId(Integer.valueOf(schedule.getId()));
      summary.setBeginTimeFrame(Long.valueOf(begin));
      summary.setEndTimeFrame(Long.valueOf(end));
      MeasurementDefinition definition = schedule.getDefinition();
      summary.setDefinitionId(Integer.valueOf(definition.getId()));
      summary.setLabel(definition.getDisplayName());
      summary.setDescription(definition.getDescription());
      summary.setMetricSource(schedule.getResource().getName());
      summary.setMetricSourceId(schedule.getResource().getId());
      switch(MeasurementChartsManagerBean.SyntheticClass_1.$SwitchMap$org$rhq$core$domain$measurement$DataType[definition.getDataType().ordinal()]) {
      case 1:
         MeasurementUnits trait1 = definition.getUnits();
         summary.setUnits(trait1.name());
         NumericType type = definition.getNumericType();
         if(type == null) {
            throw new IllegalStateException(&quot;NumericType is null, but no traits are expected here&quot;);
         }

         byte collectionType;
         switch(MeasurementChartsManagerBean.SyntheticClass_1.$SwitchMap$org$rhq$core$domain$measurement$NumericType[type.ordinal()]) {
         case 1:
            collectionType = 0;
            break;
         case 2:
            collectionType = 2;
            break;
         case 3:
            collectionType = 3;
            break;
         default:
            throw new IllegalStateException(&quot;Unknown measurement type: &quot; + type);
         }

         summary.setCollectionType(Integer.valueOf(collectionType));
         if(!narrowed) {
            MeasurementAggregate compositeHighLow = this.dataManager.getAggregate(subject, schedule.getId(), begin, end);
            if(compositeHighLow.isEmpty()) {
               summary.setValuesPresent(false);
            }

            HashMap metricValues = new HashMap();
            metricValues.put(&quot;min&quot;, new MetricDisplayValue(compositeHighLow.getMin()));
            metricValues.put(&quot;average&quot;, new MetricDisplayValue(compositeHighLow.getAvg()));
            metricValues.put(&quot;max&quot;, new MetricDisplayValue(compositeHighLow.getMax()));
            MeasurementDataNumeric currentNumeric = this.dataManager.getCurrentNumericForSchedule(schedule.getId());
            Double lastValue = Double.valueOf(currentNumeric != null?currentNumeric.getValue().doubleValue():Double.NaN);
            metricValues.put(&quot;last&quot;, new MetricDisplayValue(lastValue));
            summary.setMetrics(metricValues);
         }
         break;
      case 2:
         summary.setIsTrait(true);
         MeasurementDataTrait trait = this.dataManager.getCurrentTraitForSchedule(schedule.getId());
         if(trait != null) {
            summary.setValue(trait.getValue());
            summary.setTimestamp(trait.getTimestamp());
         } else {
            summary.setValue(&quot;- nothing found -&quot;);
            summary.setTimestamp(System.currentTimeMillis());
         }
      case 3:
         break;
      default:
         throw new IllegalStateException(&quot;Unsupported metric data type: &quot; + definition.getDataType());
      }

      return summary;
   }

   private List getAggregateMetricDisplaySummaries(Subject subject, int[] resourceIds, int[] measurementDefinitionIds, long begin, long end, boolean enabledOnly) throws MeasurementException {
      ArrayList data = new ArrayList(measurementDefinitionIds.length);
      if(resourceIds != null &amp;&amp; resourceIds.length != 0) {
         if(measurementDefinitionIds.length == 0) {
            return data;
         } else {
            MeasurementDataManagerUtility dataUtil = MeasurementDataManagerUtility.getInstance(this.rhqDs);
            int[] arr$ = measurementDefinitionIds;
            int len$ = measurementDefinitionIds.length;

            for(int i$ = 0; i$ &lt; len$; ++i$) {
               int definitionId = arr$[i$];
               int collecting = 0;
               List schedules = this.scheduleManager.findSchedulesByResourceIdsAndDefinitionId(subject, resourceIds, definitionId);
               int[] scheduleIds = new int[schedules.size()];

               for(int summary = 0; summary &lt; schedules.size(); ++summary) {
                  MeasurementSchedule definition = (MeasurementSchedule)schedules.get(summary);
                  if(definition.isEnabled()) {
                     ++collecting;
                  }

                  scheduleIds[summary] = definition.getId();
               }

               if(collecting == 0 &amp;&amp; enabledOnly) {
                  if(this.log.isTraceEnabled()) {
                     this.log.trace(&quot;There were no schedules enabled for definition id &quot; + definitionId);
                  }
               } else {
                  MetricDisplaySummary var22 = new MetricDisplaySummary();
                  var22.setNumberCollecting(collecting);
                  var22.setShowNumberCollecting(Boolean.valueOf(true));
                  var22.setDefinitionId(Integer.valueOf(definitionId));
                  var22.setBeginTimeFrame(Long.valueOf(begin));
                  var22.setAlertCount(this.alertManager.getAlertCountByMeasurementDefinitionAndResources(definitionId, resourceIds, begin, end));
                  var22.setEndTimeFrame(Long.valueOf(end));
                  MeasurementDefinition var23 = (MeasurementDefinition)this.entityManager.find(MeasurementDefinition.class, Integer.valueOf(definitionId));
                  var22.setDefinitionId(Integer.valueOf(var23.getId()));
                  var22.setUnits(var23.getUnits().getName());
                  var22.setDescription(var23.getDescription());
                  var22.setLabel(var23.getDisplayName());
                  var22.setDescription(var23.getDescription());
                  var22.setMetricSource(var23.getResourceType().getName());
                  MeasurementAggregate aggregate;
                  if(scheduleIds.length == 0) {
                     aggregate = new MeasurementAggregate((Double)null, (Double)null, (Double)null);
                     this.log.warn(&quot;No metric schedules found for def=[&quot; + var23 + &quot;] and resources [&quot; + resourceIds + &quot;], using empty aggregate&quot;);
                  } else {
                     aggregate = dataUtil.getAggregateByScheduleIds(begin, end, scheduleIds);
                  }

                  if(aggregate.isEmpty()) {
                     if(this.log.isTraceEnabled()) {
                        this.log.trace(&quot;There was no measurement data available for schedules &quot; + Arrays.toString(scheduleIds) + &quot; in the timeframe [&quot; + new Date(begin) + &quot;, &quot; + new Date(end) + &quot;]&quot;);
                     }

                     var22.setValuesPresent(false);
                  }

                  HashMap metricValues = new HashMap();
                  metricValues.put(&quot;min&quot;, new MetricDisplayValue(aggregate.getMin()));
                  metricValues.put(&quot;average&quot;, new MetricDisplayValue(aggregate.getAvg()));
                  metricValues.put(&quot;max&quot;, new MetricDisplayValue(aggregate.getMax()));
                  var22.setMetrics(metricValues);
                  data.add(var22);
               }
            }

            return data;
         }
      } else {
         return data;
      }
   }

   public Map getMetricDisplaySummariesForMetricsCompare(Subject subject, int[] resourceIds, int[] definitionIds, long begin, long end) throws MeasurementException {
      PageList resources = this.resourceManager.findResourceByIds(subject, resourceIds, true, PageControl.getUnlimitedInstance());
      HashMap measurementDefinitionsMap = new HashMap(definitionIds.length);
      ArrayList collectingDefIdList = new ArrayList();
      int[] collectingDefIds = definitionIds;
      int collectingDefIdArr = definitionIds.length;

      int definitions;
      for(definitions = 0; definitions &lt; collectingDefIdArr; ++definitions) {
         int compareMetrics = collectingDefIds[definitions];
         if(this.isMetricCollecting(subject, resourceIds, compareMetrics)) {
            collectingDefIdList.add(Integer.valueOf(compareMetrics));
         }
      }

      Integer[] var25 = (Integer[])collectingDefIdList.toArray(new Integer[collectingDefIdList.size()]);
      int[] var26 = new int[var25.length];

      for(definitions = 0; definitions &lt; var25.length; ++definitions) {
         var26[definitions] = var25[definitions].intValue();
      }

      List var27 = this.measurementDefinitionManager.findMeasurementDefinitionsByIds(subject, var25);
      Iterator var28 = var27.iterator();

      while(var28.hasNext()) {
         MeasurementDefinition i$ = (MeasurementDefinition)var28.next();
         measurementDefinitionsMap.put(Integer.valueOf(i$.getId()), i$);
      }

      HashMap var29 = new HashMap();
      Iterator var30 = resources.iterator();

      while(var30.hasNext()) {
         org.rhq.core.domain.resource.Resource resource = (org.rhq.core.domain.resource.Resource)var30.next();
         List scheds = this.scheduleManager.findSchedulesByResourceIdAndDefinitionIds(subject, resource.getId(), var26);
         int[] schedIds = new int[scheds.size()];

         for(int resourceMDS = 0; resourceMDS &lt; schedIds.length; ++resourceMDS) {
            schedIds[resourceMDS] = ((MeasurementSchedule)scheds.get(resourceMDS)).getId();
         }

         List var31 = this.getMetricDisplaySummariesForResource(subject, resource.getId(), schedIds, begin, end);
         Iterator i$1 = var31.iterator();

         while(i$1.hasNext()) {
            MetricDisplaySummary summary = (MetricDisplaySummary)i$1.next();
            Integer definitionId = summary.getDefinitionId();
            MeasurementDefinition definition = (MeasurementDefinition)measurementDefinitionsMap.get(definitionId);
            if(definition != null) {
               summary.setResource(resource);
               summary.setParent(resource.getParentResource());
               summary.setUnits(definition.getUnits().getName());
               summary.setDescription(definition.getDescription());
               summary.setLabel(definition.getDisplayName());
               summary.setMetricSource(definition.getResourceType().getName());
               Object metricsForDefinition = (List)var29.get(definition);
               if(metricsForDefinition == null) {
                  metricsForDefinition = new ArrayList();
                  var29.put(definition, metricsForDefinition);
               }

               ((List)metricsForDefinition).add(summary);
            }
         }
      }

      return var29;
   }

   private boolean isMetricCollecting(Subject subject, int[] resourceIds, int definitionId) {
      boolean isCollecting = false;
      List schedules = this.scheduleManager.findSchedulesByResourceIdsAndDefinitionId(subject, resourceIds, definitionId);
      Iterator i$ = schedules.iterator();

      while(i$.hasNext()) {
         MeasurementSchedule schedule = (MeasurementSchedule)i$.next();
         if(schedule.isEnabled()) {
            isCollecting = true;
            break;
         }
      }

      return isCollecting;
   }

   // $FF: synthetic class
   static class SyntheticClass_1 {
      // $FF: synthetic field
      static final int[] $SwitchMap$org$rhq$core$domain$measurement$NumericType;
      // $FF: synthetic field
      static final int[] $SwitchMap$org$rhq$core$domain$measurement$DataType = new int[DataType.values().length];

      static {
         try {
            $SwitchMap$org$rhq$core$domain$measurement$DataType[DataType.MEASUREMENT.ordinal()] = 1;
         } catch (NoSuchFieldError var6) {
            ;
         }

         try {
            $SwitchMap$org$rhq$core$domain$measurement$DataType[DataType.TRAIT.ordinal()] = 2;
         } catch (NoSuchFieldError var5) {
            ;
         }

         try {
            $SwitchMap$org$rhq$core$domain$measurement$DataType[DataType.CALLTIME.ordinal()] = 3;
         } catch (NoSuchFieldError var4) {
            ;
         }

         $SwitchMap$org$rhq$core$domain$measurement$NumericType = new int[NumericType.values().length];

         try {
            $SwitchMap$org$rhq$core$domain$measurement$NumericType[NumericType.DYNAMIC.ordinal()] = 1;
         } catch (NoSuchFieldError var3) {
            ;
         }

         try {
            $SwitchMap$org$rhq$core$domain$measurement$NumericType[NumericType.TRENDSUP.ordinal()] = 2;
         } catch (NoSuchFieldError var2) {
            ;
         }

         try {
            $SwitchMap$org$rhq$core$domain$measurement$NumericType[NumericType.TRENDSDOWN.ordinal()] = 3;
         } catch (NoSuchFieldError var1) {
            ;
         }

      }
   }
}
</pre>
            </div> <!-- /container -->
        </div><!-- /row-->
    </div><!-- /container main-->


<div style="text-align: left; font-size: small; color: gray; font-style: italic;">Page generated: Sep 8, 2017 11:31:17 AM</div>
    <script src="resources/js/jquery-1.10.1.min.js"></script>
    <script src="resources/js/jquery-migrate-1.4.1.min.js"></script>
    <script src="resources/js/bootstrap.min.js"></script>

    <script type="text/javascript" src="resources/libraries/jquery-ui/jquery.ui.widget.js"></script>
    <script type="text/javascript" src="resources/libraries/snippet/jquery.snippet.min.js"></script>
    <script type="text/javascript" src="resources/libraries/snippet/jquery.snippet.java-properties.js"></script>
    <script type="text/javascript" src="resources/libraries/snippet/jquery.snippet.java-manifest.js"></script>
    <script type="text/javascript" src="resources/libraries/sausage/jquery.sausage.min.js"></script>

    <script type="text/javascript">
        var script   = document.createElement("script");
        script.type  = "text/javascript";
            script.src   = "resources/js/navbar.js";
        document.body.appendChild(script);
    </script>

    <script type="text/javascript">
        $(window).on("hashchange", function () {
            window.scrollTo(window.scrollX, window.scrollY - 50);
        });
        function offsetAnchor() {
            if(location.hash.length !== 0) {
                window.scrollTo(window.scrollX, window.scrollY - 50);
            }
        }
        window.setTimeout(function() {
            offsetAnchor();
        }, 1);
        $(document).ready(function(){
            $("pre").snippet("java",{style:"ide-eclipse", showNum:true,boxFill:"#ffeeb9", box: "" });




            $('code[class]').each(function(){
                 var codeSyntax = ($(this).attr('class'));
                 if(codeSyntax) {
                    $(this).parent().snippet(codeSyntax,{style:'ide-eclipse', menu:false, showNum:false});
                 }
            });
            $(window).sausage({ page: 'li.box' });
        });

        function qs(key) {
            key = key.replace(/[*+?^$.\[\]{}()|\\\/]/g, "\\$&"); // escape RegEx meta chars
            var match = location.search.match(new RegExp("[?&]"+key+"=([^&]+)(&|$)"));
            return match && decodeURIComponent(match[1].replace(/\+/g, " "));
        }

        $(document).ready(function() {
            var defaultProjectID = 4062208;
            var selectedProject = qs("project");
            if (!selectedProject)
                selectedProject = defaultProjectID;

            $(".project-specific").each(function(index, element) {
                var currentProject = $(element).data("project-id");

                if (currentProject == selectedProject)
                    $(element).show();
                else
                    $(element).remove();
            });
            $("#main-navbar").show();
        });
    </script>

</body>
</html>
